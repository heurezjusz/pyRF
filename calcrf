#!/usr/bin/python3


import config

# parsing arguments
import argparse
parser = argparse.ArgumentParser()

parser.add_argument('files', type=str, nargs='+',
        help='names of files with data')

args = parser.parse_args()


# program itself
from utils import output_filename, execute_theoretical, execute_search

from obspy import read
from obspy.core.utcdatetime import UTCDateTime

for datafile in vars(args)['files']:
    # reading file
    data = read(datafile)
    
    data = data.slice(UTCDateTime('2007-07-16T01:25:18'), UTCDateTime('2007-07-16T01:27:03'))

    
    if config.PLOT_DATA_FROM_FILE: data.plot()

    if config.MODE == "theoretical":
        data = execute_theoretical(data)
    elif config.MODE == "search":
        data = execute_search(data)
    else:
        raise NotImplementedError

    if config.SAVE_RF:
        data.write(output_filename(datafile, prefix='rf_'), config.SAVE_FORMAT)
    if config.PLOT_RF:
        data.plot()
